{% extends 'components/detalle_base.html' %}

{% with list_url='catalogos:impuestos_lista' edit_url='catalogos:impuestos_editar' delete_url='catalogos:impuestos_eliminar' mensaje_activo='Este impuesto está disponible para usar en transacciones' mensaje_inactivo='Este impuesto no está disponible para usar' %}

{% block breadcrumb_items %}
{% include 'catalogos/includes/breadcrumb_catalogos.html' with section_url='catalogos:impuestos_lista' section_name='Impuestos' %}
{% endblock %}

{% block header_icon %}percent{% endblock %}

{% block detalle_content %}
<div class="row">
    {% include 'catalogos/includes/campo_detalle.html' with label='Código' value=object.codigo %}
    
    <div class="col-md-6 mb-3">
        <div class="text-muted small">Tipo de Impuesto</div>
        <p class="h5">
            <span class="badge 
                {% if object.tipo_impuesto == 'IVA' %}bg-primary
                {% elif object.tipo_impuesto == 'ICA' %}bg-info
                {% elif object.tipo_impuesto == 'RETEFUENTE' %}bg-warning
                {% elif object.tipo_impuesto == 'RETEIVA' %}bg-success
                {% elif object.tipo_impuesto == 'RETEICA' %}bg-secondary
                {% else %}bg-dark{% endif %}">
                {{ object.get_tipo_impuesto_display }}
            </span>
        </p>
    </div>
</div>

<div class="row">
    <div class="col-md-6 mb-3">
        <div class="text-muted small">Porcentaje</div>
        <p class="h5">
            <strong class="text-primary">{{ object.porcentaje }}%</strong>
        </p>
    </div>
    
    {% include 'catalogos/includes/campo_detalle.html' with label='Fecha de Creación' value=object.fecha_creacion|date:"d/m/Y H:i" %}
</div>

<hr>

<div class="row">
    <div class="col-12">
        <h6 class="text-muted mb-3">Ejemplo de Cálculo</h6>
        <div class="alert alert-info">
            <i class="bi bi-calculator"></i>
            Para una base de <strong>$1.000.000</strong>, el impuesto sería:
            <strong class="text-success" id="ejemplo-calculo"></strong>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const porcentaje = {{ object.porcentaje }};
    const base = 1000000;
    const impuesto = (base * porcentaje / 100);
    const formatter = new Intl.NumberFormat('es-CO', {
        style: 'currency',
        currency: 'COP',
        minimumFractionDigits: 0
    });
    const elementoEjemplo = document.getElementById('ejemplo-calculo');
    if (elementoEjemplo) {
        elementoEjemplo.textContent = formatter.format(impuesto);
    }
});
</script>
{% endblock %}

{% endwith %}
