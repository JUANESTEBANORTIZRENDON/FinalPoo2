# Configuración de CodeQL para GitHub Security
# Personalización de análisis de seguridad para Django S_CONTABLE

name: "Django S_CONTABLE CodeQL Config"

# Desactivar consultas que generan falsos positivos en Django
disable-default-queries: false

# Consultas personalizadas
queries:
  - uses: security-and-quality

# Rutas a excluir del análisis
paths-ignore:
  - 'env/**'
  - 'venv/**'
  - 'staticfiles/**'
  - 'static/**'
  - '**/migrations/**'
  - '**/tests.py'
  - '**/test_*.py'
  - 'check_*.py'
  - 'verify_*.py'
  - 'generate_*.py'

# Rutas a incluir específicamente
paths:
  - 'accounts/**'
  - 'api/**'
  - 'catalogos/**'
  - 'contabilidad/**'
  - 'core/**'
  - 'empresas/**'
  - 'facturacion/**'
  - 'reportes/**'
  - 'tesoreria/**'
  - 'ventas/**'

# Filtros de consultas para suprimir falsos positivos
query-filters:
  # Suprimir alertas de CSRF en Django
  # Razón: Django incluye protección CSRF automática mediante middleware
  - exclude:
      id: py/csrf-protection
      
  - exclude:
      id: py/insecure-csrf
      
  - exclude:
      id: py/csrf-disabled
      
  # Suprimir alertas sobre métodos HTTP mixtos en vistas de formularios
  # Razón: Patrón estándar de Django - GET muestra formulario, POST procesa
  # Django valida CSRF automáticamente en todas las peticiones POST
  - exclude:
      id: py/http-method-confusion
      
  - exclude:
      id: py/unsafe-http-verb
